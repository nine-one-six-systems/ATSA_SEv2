# Milestone v1.0: Dual-Filer MFJ/MFS Support

**Status:** SHIPPED 2026-02-04
**Phases:** 1-4
**Total Plans:** 13

## Overview

This milestone adds dual-filer support for married couples, enabling a tax professional to enter both spouses' data, see individual tax pictures side-by-side, and compare MFJ vs MFS filing status with dollar-level savings recommendations. The roadmap builds from calculation accuracy outward to UI and workflow polish -- tax numbers must be correct before anything gets displayed.

## Phases

### Phase 1: Core Dual-Filer Calculation Engine

**Goal:** A joint analysis can be triggered for two linked spouses and returns accurate MFJ totals, MFS totals per spouse, and a comparison with dollar difference and recommendation -- all cached and invalidated correctly.

**Depends on:** None (foundation phase)
**Plans:** 4 plans

Plans:
- [x] 01-01-PLAN.md — Infrastructure & Model (WAL mode, JointAnalysisSummary, model registration)
- [x] 01-02-PLAN.md — Service Layer (JointAnalysisService with MFJ/MFS calculation, cache invalidation)
- [x] 01-03-PLAN.md — Credit Eligibility (credit filtering, QBI threshold enforcement)
- [x] 01-04-PLAN.md — API Endpoints (blueprint registration, routes, comparison output)

**Requirements:**
| ID | Requirement | Status |
|----|-------------|--------|
| REQ-01 | Joint tax calculation (MFJ) | Complete |
| REQ-02 | Separate tax calculation (MFS) | Complete |
| REQ-03 | MFJ vs MFS comparison | Complete |
| REQ-04 | Income source attribution (T/S/J) | Complete |
| REQ-05 | Credit availability by filing status | Complete |
| REQ-06 | QBI threshold by filing status | Complete |
| REQ-07 | Standard deduction amounts | Complete |
| REQ-08 | Bidirectional cache invalidation | Complete |
| REQ-12 | SQLite WAL mode | Complete |
| REQ-13 | JointAnalysisSummary model | Complete |
| REQ-14 | JointAnalysisService | Complete |
| REQ-15 | Joint analysis API endpoints | Complete |

---

### Phase 2: MFS-Specific Compliance Logic

**Goal:** MFS calculations enforce all IRS compliance rules -- deduction coordination, SALT cap halving, and shared expense allocation -- so that MFS numbers are legally correct, not just mathematically computed.

**Depends on:** Phase 1
**Plans:** 3 plans

Plans:
- [x] 02-01-PLAN.md — Itemized Deduction Foundation (Client.deduction_method, ItemizedDeduction model)
- [x] 02-02-PLAN.md — Itemized Calculation & SALT Cap Logic
- [x] 02-03-PLAN.md — MFS Coordination & Joint Analysis Extension

**Requirements:**
| ID | Requirement | Status |
|----|-------------|--------|
| REQ-09 | Deduction method enforcement | Complete |
| REQ-10 | SALT cap by status | Complete |
| REQ-11 | Shared expense allocation | Complete |

---

### Phase 3: Split-Screen UI and Comparison View

**Goal:** A tax professional sees both spouses' individual tax pictures side-by-side on one screen with a consolidated MFJ vs MFS comparison below -- the centerpiece view they use with clients.

**Depends on:** Phase 1, Phase 2
**Plans:** 2 plans

Plans:
- [x] 03-01-PLAN.md — Template, Route, and Base CSS
- [x] 03-02-PLAN.md — JavaScript Implementation (Split.js, API integration)

**Requirements:**
| ID | Requirement | Status |
|----|-------------|--------|
| REQ-16 | Split-screen layout | Complete |
| REQ-17 | Resizable split panes | Complete |
| REQ-18 | Joint comparison section | Complete |
| REQ-19 | Income source breakdown | Complete |
| REQ-20 | Filing status comparison report | Complete |

---

### Phase 4: Dual-Filer Strategies and Workflow

**Goal:** Each spouse sees personalized strategy recommendations for their income type, the couple sees joint optimization strategies available only when filing together, and the full workflow is smooth end-to-end.

**Depends on:** Phase 1, Phase 3
**Plans:** 4 plans

Plans:
- [x] 04-01-PLAN.md — Spouse Linking Workflow
- [x] 04-02-PLAN.md — Document Attribution & Manual Entry
- [x] 04-03-PLAN.md — Per-Spouse Strategy Enhancement
- [x] 04-04-PLAN.md — Joint Strategies & Feasibility

**Requirements:**
| ID | Requirement | Status |
|----|-------------|--------|
| REQ-21 | Per-spouse tax strategies | Complete |
| REQ-22 | Joint optimization strategies | Complete |
| REQ-23 | Strategy feasibility flags | Complete |
| REQ-24 | Spouse linking workflow | Complete |
| REQ-25 | Document upload attribution | Complete |
| REQ-26 | Dual data entry support | Complete |

---

## Milestone Summary

**Key Decisions:**
- 4-phase structure (Calc → Compliance → UI → Strategies) — tax accuracy before display
- Split.js CDN instead of npm — no build step, 2kb library
- Service layer orchestration — JointAnalysisService coordinates existing components
- Bidirectional cache invalidation — combined hash from both spouses
- Income type detection from form types — W-2 → employee, Schedule C → self-employed

**Issues Resolved:**
- Standard deduction values updated to 2026 IRS figures (gap found in Phase 1 verification)
- All MFS credit restrictions properly enforced (EITC, student loan interest, education credits)
- SALT cap halving correctly implemented ($20k per MFS spouse)

**Technical Debt Incurred:**
- None significant — all requirements fully implemented

---

*Archived: 2026-02-04*
*For current project status, see .planning/ROADMAP.md*
